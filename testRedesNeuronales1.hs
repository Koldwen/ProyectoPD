import IA

ejemplosVotos :: [[Double]]
ejemplosVotos = 
    [[-1, -1, 1, -1, -1, 1, 1, 1, 1, 1, 1, -1, 1, 1, -1, 1],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 0],
    [1, 1, 1, -1, -1, 1, 0, 1, -1, -1, 1, 1, -1, 1, -1, 0],
    [1, -1, 1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, 1, 1],
    [0, 0, 0, -1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, 1, 1],
    [-1, 1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 0, 0],
    [1, -1, 1, -1, -1, 0, 1, 1, 1, -1, 0, 0, -1, 0, 0, 0],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1],
    [-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
    [1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1, -1, -1],
    [-1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 0, 0, 1, 1, -1, -1],
    [-1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1],
    [-1, 1, 1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, 1, 1],
    [1, 1, -1, -1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 0],
    [-1, 1, -1, 1, 1, 1, -1, 0, -1, 1, -1, 1, 1, 1, -1, 0],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, -1],
    [1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, -1, 1, 1, -1, 1],
    [-1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, 0, -1, -1, 1, 1],
    [1, 1, -1, -1, -1, -1, 1, 1, 0, -1, 1, -1, -1, -1, 1, 0],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 0, 1, 1, -1, -1],
    [1, 1, 1, -1, -1, 0, 1, 1, 1, 1, -1, -1, -1, -1, 1, 0],
    [-1, -1, 0, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1],
    [-1, -1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, 1, 1, 0],
    [1, 1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 0, 0, 1, 1],
    [-1, 1, -1, 1, -1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, 0],
    [-1, 1, -1, 1, 1, 1, -1, 0, -1, -1, 0, 0, 0, 1, -1, 0],
    [1, 1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, 1, -1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1],
    [1, 1, -1, -1, -1, -1, -1, 1, 1, -1, 1, -1, -1, -1, 1, -1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 0],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, 1, -1, 1, -1, -1, 1, 0],
    [1, 1, 1, -1, -1, 1, 0, 1, 1, -1, 1, -1, 1, -1, 1, 1],
    [-1, 1, 1, -1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 0],
    [1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -1, 1],
    [-1, 1, 1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, 0],
    [-1, 1, -1, -1, 1, 1, -1, -1, 0, -1, -1, 1, 1, 1, -1, 1],
    [1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 1, -1, -1, 1],
    [-1, 1, 1, -1, 0, 1, 1, 1, 1, 1, 1, -1, -1, 0, -1, 0],
    [-1, -1, 1, 1, 1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1],
    [1, 1, -1, -1, 1, 0, -1, -1, -1, -1, 1, -1, 1, 1, -1, 1],
    [-1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, 1, 1, 1],
    [1, 1, -1, 1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, -1, -1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 1],
    [-1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, 1, 1, 1, -1, 1],
    [1, -1, 1, -1, 1, 1, 1, -1, 0, -1, 1, -1, 1, 1, 1, 0],
    [-1, 1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 0, -1, 0],
    [-1, 1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, 0, 0, 0, 0],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, -1],
    [1, 1, 1, -1, 0, 1, -1, 0, -1, -1, 1, -1, 1, 1, -1, 0],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1],
    [-1, 1, 1, -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 0],
    [1, 0, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 0, 1, 1, 1],
    [1, 1, 1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, 0],
    [-1, -1, 1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, -1, 0, 1],
    [1, 1, -1, 1, 1, 1, -1, 0, -1, -1, 1, 1, 1, 1, -1, -1],
    [-1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 0, -1, 1, 0],
    [1, 1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1],
    [1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1],
    [-1, -1, 1, -1, -1, 1, 1, 0, 1, 1, 1, -1, -1, -1, 1, 1],
    [-1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, 0],
    [-1, 1, 1, -1, 1, 0, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1],
    [-1, 0, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, -1],
    [1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1],
    [1, 1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, 1],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1],
    [-1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, 1, -1, 1, 1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1],
    [-1, -1, -1, 1, 1, 1, 1, 1, 1, 1, -1, 1, 1, 1, 0, 1],
    [1, 1, 1, 0, -1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 0, 1],
    [1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 0, 1, 1, -1, -1],
    [1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1],
    [1, 1, 0, 0, 0, 1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1],
    [-1, -1, 1, 1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, -1, 1],
    [-1, 0, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1],
    [1, 1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 0, 0],
    [1, -1, 1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, 1, 1, 1],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, 1],
    [1, 1, 1, -1, -1, -1, 1, 1, 0, -1, 1, -1, -1, -1, 1, 0],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 0],
    [1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 0, 1, 1, 1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, -1, 1],
    [-1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, 1, 1],
    [1, 1, 1, -1, 1, 1, -1, 1, 1, -1, 1, -1, -1, 1, -1, 0],
    [1, -1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, 0],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1],
    [1, 1, -1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, 1, -1, 0],
    [-1, 1, 1, -1, 1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1],
    [1, 1, -1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, 1, -1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, 1, -1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 0, 1],
    [-1, 0, -1, -1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 0],
    [1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1],
    [1, 0, 1, -1, -1, -1, 1, 1, 1, -1, -1, 0, -1, -1, 1, 1],
    [1, 0, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1],
    [-1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 0],
    [1, 1, 1, -1, -1, 0, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1],
    [-1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1],
    [-1, 1, 1, -1, -1, 0, 1, 1, 1, 1, 1, -1, 0, 1, 1, 1],
    [-1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 0, 0, -1, 0],
    [-1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, 1, 1]]

clasesVotos :: [Double]
clasesVotos= [1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1,
  0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0,
  0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1,
  0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1,
  0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0]

conjEntrenamiento :: [([Double], [Double])]
conjEntrenamiento = [(ejemplosVotos!!i, [clasesVotos!!i])  | i <- [0..(length ejemplosVotos)-1] ]

pesosIniciales :: Double
pesosIniciales = 1
entradasFicticias :: Double
entradasFicticias = 1
neuronasPorCapa :: [Int]
neuronasPorCapa = [16,4,2,1]
funcionesDeActivacion :: [Double -> Double]
funcionesDeActivacion = [IA.sigmoide, IA.sigmoide,IA.sigmoide]
funcionesDerivadas :: [Double -> Double]
funcionesDerivadas = [IA.dSigmoide, IA.dSigmoide, IA.dSigmoide]

aciertosRed :: Red -> [([Double], [Double])] -> Int 
aciertosRed r ls = sum [ if (round (head (predecir r x)))==round(head l) then 1 else 0 | (x,l) <- ls]

redVotos :: Red
redVotos = crear pesosIniciales entradasFicticias neuronasPorCapa funcionesDeActivacion funcionesDerivadas

estadisticas :: Int -> Double -> IO()
estadisticas epochs lr = do
    let redVotos' = IA.retropropagacion redVotos conjEntrenamiento epochs lr 
    putStrLn $ "### Datos del conjunto de entrenamiento ###"
    putStrLn $ "Número de ejemplos: " ++ (show (length ejemplosVotos))
    putStrLn $ "###########################################\n"
    putStrLn $ "### Datos de la red inicial ###"
    putStrLn $ "Pesos iniciales: " ++ (show pesosIniciales)
    putStrLn $ "Entradas ficticias: " ++ (show entradasFicticias)
    putStrLn $ "Neuronas por capa: " ++ (show neuronasPorCapa)
    putStrLn $ "Tasa de aprendizaje: " ++ (show lr)
    putStrLn $ "Número de épocas: " ++ (show epochs)
    putStrLn $ "###########################################\n"
    putStrLn $ "### Número de aciertos ###"
    putStrLn $ "Antes del entrenamiento: " ++ (show (aciertosRed redVotos conjEntrenamiento))
    putStrLn $ "Después del entrenamiento: " ++ (show (aciertosRed redVotos' conjEntrenamiento))
    putStrLn $ "##############################################"
    return ()